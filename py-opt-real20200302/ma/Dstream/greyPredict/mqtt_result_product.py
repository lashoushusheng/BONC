# !/usr/bin/python
# -*- coding: utf-8 -*-
from kafka import KafkaConsumer

from CConfig import conf
import paho.mqtt.client as mqtt
import ast
import pandas as pd
import numpy as np
import time
import json

from DPublic.MyLog import MyLog

logFname = '{}/rtc_kafka_2db.log'.format(conf.LOG_PATH)
mylog = MyLog(logFname, level=conf.LOG_LEVEL).logger

list = [
{"actual": [{"date": "2017-01-28 10:28:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:32:30", "prediction": 497.49, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.49, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.49, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:29:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}], "predict": [{"date": "2017-01-28 10:32:45", "prediction": 497.49, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.48, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:29:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}], "predict": [{"date": "2017-01-28 10:33:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.47, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:29:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:29:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:33:15", "prediction": 497.5, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.5, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.5, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:29:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:33:30", "prediction": 497.52, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.53, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.53, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:30:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:33:45", "prediction": 497.55, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.55, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.55, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:30:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:34:00", "prediction": 497.57, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.57, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.58, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:30:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:34:15", "prediction": 497.57, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.58, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.59, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:30:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:34:30", "prediction": 497.58, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.59, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.59, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:31:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:34:45", "prediction": 497.6, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.61, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.62, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:31:15", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:35:00", "prediction": 497.6, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.61, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.61, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:31:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:35:15", "prediction": 497.62, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.62, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.63, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:31:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:35:30", "prediction": 497.63, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:32:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:35:45", "prediction": 497.65, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.66, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.67, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:32:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:36:00", "prediction": 497.67, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.68, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.69, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:32:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:36:15", "prediction": 497.67, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.68, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.69, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:32:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:36:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.65, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.65, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:33:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:36:45", "prediction": 497.62, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.63, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.63, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:33:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:37:00", "prediction": 497.63, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.63, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.64, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:33:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}], "predict": [{"date": "2017-01-28 10:37:15", "prediction": 497.63, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.64, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:33:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:37:30", "prediction": 497.61, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.61, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.62, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:34:00", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:37:45", "prediction": 497.59, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.59, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.59, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:34:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:38:00", "prediction": 497.57, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.57, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.56, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:34:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}], "predict": [{"date": "2017-01-28 10:38:15", "prediction": 497.54, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.53, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.53, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:34:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}], "predict": [{"date": "2017-01-28 10:38:30", "prediction": 497.53, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.52, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.51, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:35:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}], "predict": [{"date": "2017-01-28 10:38:45", "prediction": 497.5, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.49, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.48, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:35:15", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}], "predict": [{"date": "2017-01-28 10:39:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.47, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.46, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:35:30", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}], "predict": [{"date": "2017-01-28 10:39:15", "prediction": 497.44, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.43, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.42, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:35:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}], "predict": [{"date": "2017-01-28 10:39:30", "prediction": 497.42, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:40:00", "prediction": 497.38, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:36:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.4, "isFault": 0}], "predict": [{"date": "2017-01-28 10:39:45", "prediction": 497.39, "isFault": 0}, {"date": "2017-01-28 10:40:00", "prediction": 497.38, "isFault": 0}, {"date": "2017-01-28 10:40:15", "prediction": 497.36, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:36:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.36, "isFault": 0}], "predict": [{"date": "2017-01-28 10:40:00", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:15", "prediction": 497.34, "isFault": 0}, {"date": "2017-01-28 10:40:30", "prediction": 497.32, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:36:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:00", "prediction": 497.32, "isFault": 0}], "predict": [{"date": "2017-01-28 10:40:15", "prediction": 497.31, "isFault": 0}, {"date": "2017-01-28 10:40:30", "prediction": 497.29, "isFault": 0}, {"date": "2017-01-28 10:40:45", "prediction": 497.27, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:36:45", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:00", "prediction": 497.32, "isFault": 0}, {"date": "2017-01-28 10:40:15", "prediction": 497.36, "isFault": 0}], "predict": [{"date": "2017-01-28 10:40:30", "prediction": 497.3, "isFault": 0}, {"date": "2017-01-28 10:40:45", "prediction": 497.28, "isFault": 0}, {"date": "2017-01-28 10:41:00", "prediction": 497.26, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:37:00", "prediction": 497.64, "isFault": 0}, {"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:00", "prediction": 497.32, "isFault": 0}, {"date": "2017-01-28 10:40:15", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:30", "prediction": 497.32, "isFault": 0}], "predict": [{"date": "2017-01-28 10:40:45", "prediction": 497.29, "isFault": 0}, {"date": "2017-01-28 10:41:00", "prediction": 497.27, "isFault": 0}, {"date": "2017-01-28 10:41:15", "prediction": 497.25, "isFault": 0}], "accuracy": 0.99},
{"actual": [{"date": "2017-01-28 10:37:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:30", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:37:45", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:00", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:15", "prediction": 497.56, "isFault": 0}, {"date": "2017-01-28 10:38:30", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:38:45", "prediction": 497.48, "isFault": 0}, {"date": "2017-01-28 10:39:00", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:15", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:30", "prediction": 497.4, "isFault": 0}, {"date": "2017-01-28 10:39:45", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:00", "prediction": 497.32, "isFault": 0}, {"date": "2017-01-28 10:40:15", "prediction": 497.36, "isFault": 0}, {"date": "2017-01-28 10:40:30", "prediction": 497.32, "isFault": 0}, {"date": "2017-01-28 10:40:45", "prediction": 497.28, "isFault": 0}], "predict": [{"date": "2017-01-28 10:41:00", "prediction": 497.26, "isFault": 0}, {"date": "2017-01-28 10:41:15", "prediction": 497.24, "isFault": 0}, {"date": "2017-01-28 10:41:30", "prediction": 497.22, "isFault": 0}], "accuracy": 0.99}
]

class soft_Result_Kafka_2_mqtt(object):
    """
    kafka to mqtt
    """
    def __init__(self):
        # kafka parameter
        self.kafkaConsumer = KafkaConsumer(
            conf.KAFKA_GREY_RESULT_TOPIC, bootstrap_servers=[conf.KAFKA_URL]
        )
        # mqtt init
        self.mqttClient = mqtt.Client()
        # 保存实际值
        self.actualDF = pd.DataFrame(columns=['date', 'prediction', 'isFault'])
        # 保存预测值
        self.predictionDF = pd.DataFrame(columns=['date', 'prediction', 'isFault'])
        self.AccuracyList = []
        self.LastTime = ""

    # 连接MQTT服务器
    def on_mqtt_connect(self):
        self.mqttClient.connect(conf.EMQ_HOST, conf.EMQ_PORT, conf.EMQ_PRODUCER_KEEPALIVE)
        self.mqttClient.loop_start()

    # publish 消息
    def on_publish(self, topic, payload, qos):
        self.mqttClient.publish(topic, payload, qos)

    # 消息处理函数
    def on_message_come(self, lient, userdata, msg):
        print(msg.topic + " " + ":" + str(msg.payload))

    # subscribe 消息
    def on_subscribe(self):
        self.mqttClient.subscribe("/server", 1)
        self.mqttClient.on_message = self.on_message_come  # 消息到来处理函数

    def kafa_2_mqtt(self):
        for msg in self.kafkaConsumer:
            vKey = None
            vValue = bytes.decode(msg.value)
            # print(vValue)
            resList = ast.literal_eval(vValue)
            Result = {}

            if len(resList) == 18:
                actualValue = resList[0:15]
                predictionValue = resList[15:]
                # print(actualValue)
                # print(predictionValue)
                # accuracy = self.mean_accuracy1(actualValue, predictionValue)
                # self.mean_accuracy1(actualValue, predictionValue)
                # print("平均预测准确度")
                # print(accuracy)

                Result['actual'] = actualValue
                Result['predict'] = predictionValue
                Result['accuracy'] = 0.99
                print(json.dumps(Result))
                self.on_publish(conf.EMQ_TOPIC, json.dumps(Result), 1)


if __name__ == '__main__':
    result = soft_Result_Kafka_2_mqtt()
    result.on_mqtt_connect()
    # result.kafa_2_mqtt()
    while True:
        for i in list:
            result.on_publish(conf.EMQ_TOPIC, json.dumps(i), 1)
            time.sleep(2)


